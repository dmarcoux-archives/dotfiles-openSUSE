################################
#
# Dependencies:
# fontawesome-fonts
#
################################

#################
# Variables
#################

# Modifier key is the Windows Key
set $mod Mod4

# Workspaces
set $WS1 "1:1"
set $WS2 "2:2"
set $WS3 "3:3"
set $WS4 "4:4"
set $WS5 "5:5"

#################
# Colorscheme
#################

# Solarized (Light) colors
# Without alpha (for i3)
set $black         #002B36
set $grey          #839496
set $dark_beige    #EEE8D5
set $light_beige   #FDF6E3
set $yellow        #B58900
set $orange        #CB4B16
set $red           #DC322F
set $magenta       #D33682
set $violet        #6C71C4
set $blue          #268BD2
set $cyan          #2AA198
set $green         #859900
# With alpha, fully opaque (for i3lock-color)
set $black_a       #002B36FF
set $grey_a        #839496FF
set $dark_beige_a  #EEE8D5FF
set $light_beige_a #FDF6E3FF
set $yellow_a      #B58900FF
set $orange_a      #CB4B16FF
set $red_a         #DC322FFF
set $magenta_a     #D33682FF
set $violet_a      #6C71C4FF
set $blue_a        #268BD2FF
set $cyan_a        #2AA198FF
set $green_a       #859900FF


# TYPE                   BORDER BACKGROUND TEXT
client.focused           $green $green     $light_beige
client.unfocused         $grey  $grey      $light_beige
client.focused_inactive  $grey  $grey      $light_beige
client.urgent            $red   $red       $light_beige

#################
# Settings
#################

# Window focus doesn't follow mouse movements
focus_follows_mouse no

# Focus stays in the same parent container
force_focus_wrapping yes

# New containers on workspace starts in tabbed mode
workspace_layout tabbed

# Font for window titles. Will also be used by the bar unless a different font is used in the bar {} block below.
font pango:DejaVu Sans Mono 13

# Use LeftMouse+$mod on a floating window's title to drag it to the wanted position
# Use RightMouse+$mod on a floating window to resize it
floating_modifier $mod

bar {
    status_command i3status
    position top
    font pango:DejaVu Sans Mono 13
    strip_workspace_numbers yes

    colors {
        # Solarized (Light) colors
        background $light_beige
        statusline $grey
        separator  $grey

        # TYPE              BORDER      BACKGROUND  TEXT
        focused_workspace   $green      $green      $light_beige
        active_workspace    $violet     $violet     $light_beige
        inactive_workspace  $dark_beige $dark_beige $grey
        urgent_workspace    $red        $red        $light_beige
    }
}

exec --no-startup-id ~/dotfiles/scripts/set_keyboard_layout.sh

exec_always --no-startup-id ~/dotfiles/scripts/set_xrandr_dpi.sh

# Set monitors' configuration
exec_always --no-startup-id ~/dotfiles/scripts/set_xrandr_both.sh

#################
# Applications
#################

# Assign applications to workspaces to have them start on a specific workspace
assign [class="^Firefox"] → $WS2
assign [class="^Vlc$"] → $WS3

# Kill potentially hung up audio server (it happens when a user logs out and back in)
exec --no-startup-id killall pulseaudio

# Start audio server
exec --no-startup-id pulseaudio --start

# Start volume mixer
exec --no-startup-id pnmixer

# Start daemon for automounting optical and removable drives
exec --no-startup-id udiskie --tray

# Start clipboard manager
exec --no-startup-id clipmenud

# Start a terminal
exec termite

# Start a web browser
exec $BROWSER

# Start time+location-based color temperature adjuster for monitors
exec --no-startup-id redshift-gtk -c ~/.config/redshift/config

# Start network manager
exec --no-startup-id nm-applet

# Start emacs server (to launch spacemacs quickly)
exec --no-startup-id emacs --daemon

# Start battery monitor if needed
exec --no-startup-id ~/dotfiles/scripts/monitor_battery.sh

# Start idle mouse cursor hider
exec --no-startup-id unclutter

#################
# Key bindings
#################

# Brightness adjustment function keys
bindsym XF86MonBrightnessUp exec --no-startup-id xbacklight -inc 5
bindsym XF86MonBrightnessDown exec --no-startup-id xbacklight -dec 5

# Restart i3 (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart

# To be able to shutdown and reboot, do the following:
# 1. sudo visudo -f /etc/sudoers.d/shutdown
# 2. dany ALL = NOPASSWD: /usr/bin/systemctl poweroff,/usr/bin/systemctl reboot
set $system_mode System: (l) Lock, (Shift+q) Logout, (Shift+s) Shutdown, (Shift+r) Reboot, (Escape) Go back to default mode
mode "$system_mode" {
    # Lock the system
    bindsym l exec --no-startup-id "i3lock \
                     --ignore-empty-password \
                     --blur=5 \
                     --indicator \
                     --force-clock \
                     --insidevercolor=$dark_beige_a \
                     --insidewrongcolor=$red_a \
                     --insidecolor=$dark_beige_a \
                     --ringvercolor=$green_a \
                     --ringwrongcolor=$red_a \
                     --ringcolor=$grey_a \
                     --line-uses-inside \
                     --keyhlcolor=$green_a \
                     --bshlcolor=$red_a \
                     --separatorcolor=$dark_beige_a \
                     --textcolor=$dark_beige_a \
                     --timecolor=$black_a \
                     --datecolor=$black_a \
                     --datestr='%a %d, %B %Y' \
                     --veriftext='' \
                     --wrongtext='' \
                     --radius=180" \
                     , mode "default"

    # Logout of the current session
    bindsym Shift+q exec --no-startup-id i3-msg exit

    # Reboot the system
    bindsym Shift+r exec --no-startup-id systemctl reboot

    # Shutdown the system
    bindsym Shift+s exec --no-startup-id systemctl poweroff

    # Exit the system mode with Escape
    bindsym Escape mode "default"
}
bindsym $mod+Pause mode "$system_mode"

# Start a terminal
bindsym $mod+Return exec termite

# Kill the focused window
bindsym $mod+Shift+Escape kill

# Start program launcher
bindsym $mod+d exec rofi -show drun # Only list applications shipping a .desktop file

# Start window switcher
bindsym $mod+s exec rofi -show window

# Start rofi frontend to pass-otp for my two-factor authentication (2FA) codes
bindsym $mod+o exec rofi -show pass-otp

# Start rofi frontend to pass for my passwords
bindsym $mod+p exec rofi -show pass

# Start rofi frontend to clipboard manager
bindsym $mod+c exec clipmenu -p 'clipboard'

# Change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# Move the focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# Move the focused workspace between monitors
bindsym $mod+Control+h move workspace to output left
bindsym $mod+Control+j move workspace to output down
bindsym $mod+Control+k move workspace to output up
bindsym $mod+Control+l move workspace to output right

# Enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle

# Change container layout (tabbed, toggle split)
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# Focus the parent container
bindsym $mod+Shift+a focus parent

# Focus the child container
bindsym $mod+a focus child

# Switch to workspace
bindsym $mod+1 workspace $WS1
bindsym $mod+2 workspace $WS2
bindsym $mod+3 workspace $WS3
bindsym $mod+4 workspace $WS4
bindsym $mod+5 workspace $WS5

# Move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $WS1
bindsym $mod+Shift+2 move container to workspace $WS2
bindsym $mod+Shift+3 move container to workspace $WS3
bindsym $mod+Shift+4 move container to workspace $WS4
bindsym $mod+Shift+5 move container to workspace $WS5

# Toggle the floating mode for the window
bindsym $mod+Tab floating toggle
